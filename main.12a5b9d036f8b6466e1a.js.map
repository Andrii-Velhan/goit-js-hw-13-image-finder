{"version":3,"sources":["webpack:///./js/apiService.js","webpack:///./index.js","webpack:///./js/get-refs.js","webpack:///./templates/image-card.hbs"],"names":["ImageApiService","this","searchQuery","page","per_page","fetchArticles","url","BASE_URL","URLSearchParams","image_type","orientation","q","key","console","log","fetch","then","r","json","data","incrementPage","hits","resetPage","newQuery","debounce","require","refs","cardContainer","document","querySelector","searchForm","sentinel","addEventListener","e","preventDefault","clearResult","imageApiService","query","target","value","length","error","text","type","delay","status","renderArticlesCard","catch","onFetchError","markUp","articlesCardTpl","insertAdjacentHTML","dir","alert","innerHTML","IntersectionObserver","entries","forEach","entry","isIntersecting","rootMargin","observe","event","basicLightbox","nodeName","instance","create","dataset","sourse","show","Handlebars","module","exports","template","container","depth0","helpers","partials","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","program","noop"],"mappings":"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","file":"main.12a5b9d036f8b6466e1a.js","sourcesContent":["const BASE_URL = `https://pixabay.com/api/`;\r\nconst MY_KEY = `19199733-53a137615acbd00e25277177c`;\r\n\r\nexport default class ImageApiService {\r\n    constructor() {\r\n        this.searchQuery = '';\r\n        this.page = 1;\r\n        this.per_page = 12;\r\n     }\r\n    \r\n    fetchArticles() {\r\n        const searchParams = new URLSearchParams({\r\n            image_type: 'photo',\r\n            orientation: 'horizontal',\r\n            q: this.searchQuery,\r\n            page: this.page,\r\n            per_page: this.per_page,\r\n            key: MY_KEY, \r\n        });\r\n     \r\n        const url = `${BASE_URL}?${searchParams}`;\r\n\r\n        console.log('this from API:', this);\r\n      \r\n        return fetch(url)\r\n            .then(r => r.json())\r\n            .then((data) => {                \r\n                this.incrementPage();\r\n                console.log('this is hits from API:', data.hits);\r\n                return data;\r\n            }); \r\n    }\r\n\r\n    incrementPage() {\r\n        this.page += 1;\r\n    }\r\n    resetPage() {\r\n        this.page = 1;\r\n    }\r\n\r\n    get query() {\r\n        return this.searchQuery;\r\n    }\r\n\r\n    set query(newQuery) {\r\n        this.searchQuery = newQuery;\r\n    }\r\n}\r\n","import './styles.css';\nimport articlesCardTpl from './templates/image-card.hbs'\nimport ImageApiService from './js/apiService';\nimport getRefs from './js/get-refs';\nimport '@pnotify/core/dist/BrightTheme.css';\nimport '@pnotify/core/dist/PNotify.css';\nimport { error } from '@pnotify/core';\nimport * as basicLightbox from 'basiclightbox';\nimport '../node_modules/basiclightbox/dist/basicLightbox.min.css';\n\nconst debounce = require('lodash.debounce');\nconst refs = getRefs();\n\nrefs.searchForm.addEventListener('input', debounce(onSearch, 500));\nconst imageApiService = new ImageApiService();\n\nfunction onSearch(e) {\n    e.preventDefault();\n\n    clearResult();\n    imageApiService.query = e.target.value;\n    imageApiService.resetPage();\n    \n    if (imageApiService.query.length === 0) {\n        clearResult();\n        return\n    }\n\n    if (imageApiService.query === ' ' ||\n        imageApiService.query === '  ' ||\n        imageApiService.query === '   ') {        \n               return error({\n            text: 'Input something real ! ! !',\n            type: 'info',\n            delay: 2500           \n        }); \n    }\n\n     if (imageApiService.query.status === 404) {\n        clearResult();\n        console.log('not find');\n        return error({\n            text: 'The articles for your request was not found. Please try again',\n            type: 'info',\n            delay: 2500           \n        });        \n    } \n    \n    imageApiService.fetchArticles().then(renderArticlesCard)\n        .catch(onFetchError);\n}\n\nfunction renderArticlesCard(hits) {\n    const markUp = articlesCardTpl(hits);  \n\n    refs.cardContainer.insertAdjacentHTML('beforeend', markUp);\n}\n\nfunction onFetchError(error) {\n    console.log('Это CATCH!!!');            \n    console.dir(error);\n    alert('Упс, что-то пошло не так');\n}\n\nfunction clearResult() {   \n    refs.cardContainer.innerHTML = '';\n}\n\nconst onEntry = entries => {\n    entries.forEach(entry => {\n        if (entry.isIntersecting && imageApiService.query !== '') {\n            console.log('it is time to load more images');\n            imageApiService.fetchArticles().then(renderArticlesCard)\n                .catch(onFetchError);  \n        }\n    });\n};\n\nconst options = {\n    rootMargin: '350px',\n};\nconst observer = new IntersectionObserver(onEntry, options);\nobserver.observe(refs.sentinel);\n\n\nrefs.cardContainer.addEventListener('click', onClickImg)\n\nfunction onClickImg(event) {\n    const basicLightbox = require('basiclightbox')\n  if (event.target.nodeName !== 'IMG')\n  {\n    return\n    }\n    const instance = basicLightbox.create(`<img src=\"${event.target.dataset.sourse}\">`)\n    console.log(event.target.dataset.sourse);\n    instance.show()\n}","export default function getRefs() {\r\n   return {\r\n      cardContainer: document.querySelector('.gallery'),\r\n      searchForm: document.querySelector('#search-form'),   \r\n      sentinel: document.querySelector('#sentinel'),\r\n   };\r\n}","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.hooks.helperMissing, alias3=\"function\", alias4=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<li class=\\\"gallery__item\\\">\\r\\n    <div class=\\\"photo-card\\\">\\r\\n        <img class=\\\"gallery__image\\\" src=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"webformatURL\") || (depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"webformatURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":4,\"column\":41},\"end\":{\"line\":4,\"column\":57}}}) : helper)))\n    + \"\\\" data-sourse=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"largeImageURL\") || (depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"largeImageURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":4,\"column\":72},\"end\":{\"line\":4,\"column\":89}}}) : helper)))\n    + \"\\\" alt=\\\"\\\" />\\r\\n\\r\\n        <div class=\\\"stats\\\">\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">thumb_up</i>\\r\\n                \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"likes\") || (depth0 != null ? lookupProperty(depth0,\"likes\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"likes\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":9,\"column\":16},\"end\":{\"line\":9,\"column\":25}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">visibility</i>\\r\\n                \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"views\") || (depth0 != null ? lookupProperty(depth0,\"views\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"views\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":13,\"column\":16},\"end\":{\"line\":13,\"column\":25}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">comment</i>\\r\\n                \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"comments\") || (depth0 != null ? lookupProperty(depth0,\"comments\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"comments\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":17,\"column\":16},\"end\":{\"line\":17,\"column\":28}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">cloud_download</i>\\r\\n                \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"downloads\") || (depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"downloads\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":21,\"column\":16},\"end\":{\"line\":21,\"column\":29}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n        </div>\\r\\n    </div>\\r\\n</li>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),(depth0 != null ? lookupProperty(depth0,\"hits\") : depth0),{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":0},\"end\":{\"line\":26,\"column\":9}}})) != null ? stack1 : \"\");\n},\"useData\":true});"],"sourceRoot":""}